<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{{ invoice.invoice_id }} ‚Äî Smart Invoice</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(135deg, #0a0118 0%, #1a0a2e 50%, #0a0118 100%);
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    .glass {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }
    .btn-animate {
      transition: all 0.3s ease;
      transform: scale(1);
    }
    .btn-animate:hover {
      transform: scale(1.05) translateY(-2px);
      box-shadow: 0 10px 25px rgba(139, 92, 246, 0.4);
    }
    .gradient-text {
      background: linear-gradient(135deg, #a855f7, #ec4899);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
  </style>
</head>

<body class="text-gray-100 min-h-screen flex flex-col items-center py-12 px-4">

  <!-- Header -->
  <header class="mb-10 text-center">
    <h1 class="text-4xl md:text-5xl font-bold mb-2 gradient-text">Invoice {{ invoice.invoice_id }}</h1>
    <p class="text-gray-400">Issued to <span class="font-semibold text-white">{{ invoice.client_name }}</span></p>
  </header>

  <!-- Main Card -->
  <main class="glass rounded-2xl shadow-2xl p-6 md:p-8 w-full max-w-3xl">
    <!-- Invoice Info -->
    <div class="bg-gray-900/50 rounded-xl p-6 mb-6 border border-white/10">
      <h2 class="text-xl font-bold mb-4 text-violet-300">üìã Invoice Details</h2>
      <div class="grid md:grid-cols-2 gap-4 text-sm">
        <div>
          <p class="text-gray-400">Business Name</p>
          <p class="font-semibold text-white">{{ invoice.business_name }}</p>
        </div>
        <div>
          <p class="text-gray-400">Client Name</p>
          <p class="font-semibold text-white">{{ invoice.client_name }}</p>
        </div>
        <div>
          <p class="text-gray-400">Contact</p>
          <p class="font-semibold text-white">{{ invoice.client_email_or_whatsapp|default:"Not provided" }}</p>
        </div>
        <div>
          <p class="text-gray-400">Amount</p>
          <p class="font-semibold text-white text-lg">{{ invoice.currency }} {{ invoice.amount }}</p>
        </div>
      </div>
      {% if invoice.description %}
      <div class="mt-4">
        <p class="text-gray-400">Description</p>
        <p class="text-white">{{ invoice.description }}</p>
      </div>
      {% endif %}
      {% if invoice.notes %}
      <div class="mt-4">
        <p class="text-gray-400">Notes</p>
        <p class="text-white italic">{{ invoice.notes }}</p>
      </div>
      {% endif %}
    </div>

    <!-- Action Buttons -->
    <div class="mt-8 flex flex-wrap gap-3 justify-center">
      <a href="{% url 'invoice_pdf' invoice.pk %}" 
         class="btn-animate px-6 py-3 bg-gradient-to-r from-violet-600 to-fuchsia-600 rounded-xl text-white font-semibold shadow-lg">
        üìÑ Download PDF
      </a>

      <a href="{% url 'create_invoice' %}" 
         class="btn-animate px-6 py-3 border border-gray-500 rounded-xl hover:bg-gray-800">
        ‚ûï Create Another
      </a>

      <a href="{% url 'landing_page' %}" 
         class="btn-animate px-6 py-3 border border-gray-500 rounded-xl hover:bg-gray-800">
        ‚¨ÖÔ∏è Back to Home
      </a>
    </div>

    <!-- Email Sending Section -->
    <div class="mt-10 bg-gray-900/50 p-6 rounded-xl border border-white/10">
      <h3 class="text-lg font-bold mb-4 text-green-400">‚úâÔ∏è Send via Email</h3>
      
      {% if success %}
        <div class="bg-green-500/20 border border-green-500/50 text-green-300 p-3 rounded-lg mb-4 text-sm">
          ‚úì {{ success }}
        </div>
      {% endif %}
      {% if error %}
        <div class="bg-red-500/20 border border-red-500/50 text-red-300 p-3 rounded-lg mb-4 text-sm">
          ‚úó {{ error }}
        </div>
      {% endif %}

      <form method="post" action="{% url 'send_invoice_email' invoice.pk %}">
        {% csrf_token %}
        <label class="text-sm text-gray-400 mb-2 block">Recipient Email Address</label>
        <input type="email" name="to_email" 
               placeholder="client@example.com" 
               value="{{ invoice.client_email_or_whatsapp|default:'' }}"
               class="w-full p-3 rounded-lg bg-black/30 border border-white/10 text-sm text-gray-200 focus:outline-none focus:border-violet-500 focus:ring-2 focus:ring-violet-500/50" />

        <button type="submit" 
                class="mt-4 btn-animate w-full px-5 py-3 bg-green-600 rounded-lg hover:bg-green-500 font-medium shadow-lg">
          üìß Send Email with PDF Attachment
        </button>
      </form>
    </div>

    <!-- WhatsApp Sending Section -->
    <div class="mt-6 bg-gray-900/50 p-6 rounded-xl border border-white/10">
      <h3 class="text-lg font-bold mb-4 text-green-400">üí¨ Send via WhatsApp</h3>
      
      {% if whatsapp_success %}
        <div class="bg-green-500/20 border border-green-500/50 text-green-300 p-3 rounded-lg mb-4 text-sm">
          ‚úì {{ whatsapp_success }}
        </div>
      {% endif %}
      {% if whatsapp_error %}
        <div class="bg-yellow-500/20 border border-yellow-500/50 text-yellow-300 p-3 rounded-lg mb-4 text-sm">
          ‚ö†Ô∏è {{ whatsapp_error }}
          {% if 'not configured' in whatsapp_error %}
            <div class="mt-2 text-xs">
              <p>To enable WhatsApp functionality:</p>
              <ol class="list-decimal list-inside mt-1 ml-2">
                <li>Set up a Twilio account</li>
                <li>Add your TWILIO_ACCOUNT_SID and TWILIO_AUTH_TOKEN as secrets</li>
                <li>Configure your WhatsApp number in TWILIO_WHATSAPP_NUMBER</li>
              </ol>
            </div>
          {% endif %}
        </div>
      {% endif %}

      <form method="post" action="{% url 'send_invoice_whatsapp' invoice.pk %}">
        {% csrf_token %}
        <label class="text-sm text-gray-400 mb-2 block">Recipient WhatsApp Number (with country code)</label>
        <input type="tel" name="whatsapp_number" 
               placeholder="+1234567890" 
               value="{{ invoice.client_email_or_whatsapp|default:'' }}"
               class="w-full p-3 rounded-lg bg-black/30 border border-white/10 text-sm text-gray-200 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-500/50" />
        
        <p class="text-xs text-gray-500 mt-2">üí° Include country code (e.g., +1 for USA, +44 for UK)</p>

        <button type="submit" 
                class="mt-4 btn-animate w-full px-5 py-3 bg-gradient-to-r from-green-500 to-green-600 rounded-lg hover:from-green-600 hover:to-green-700 font-medium shadow-lg">
          üí¨ Send via WhatsApp with PDF
        </button>
      </form>
    </div>
  </main>

  <!-- Footer -->
  <footer class="mt-12 text-gray-400 text-sm text-center px-4 max-w-2xl">
    <p>Built with ‚ù§Ô∏è by <strong class="text-violet-400">Jeffery Onome</strong></p>
    <p class="text-xs mt-2">Powered by Django, Twilio & Tailwind CSS</p>
  </footer>

</body>
</html>
